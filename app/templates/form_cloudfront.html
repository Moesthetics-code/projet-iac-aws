<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SONATEL IAC ‚Äî D√©ploiement CloudFront</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Sora:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --navy-900: #060d1f;
            --violet:   #a855f7;
            --violet-dim:#9333ea;
            --cyan:     #0ea5e9;
            --green:    #22c55e;
            --red:      #ef4444;
            --white:    #f8fafc;
            --gray-300: #94a3b8;
            --card-bg:  rgba(10, 22, 40, 0.92);
            --border:   rgba(168, 85, 247, 0.18);
            --glow:     0 0 24px rgba(168,85,247,0.25);
            --radius:   14px;
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Sora', sans-serif;
            background: #060d1f;
            color: #f8fafc;
            min-height: 100vh;
            zoom: 0.8;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image:
                linear-gradient(rgba(168,85,247,0.04) 1px, transparent 1px),
                linear-gradient(90deg, rgba(168,85,247,0.04) 1px, transparent 1px);
            background-size: 48px 48px;
            pointer-events: none;
            z-index: 0;
        }

        body::after {
            content: '';
            position: fixed;
            width: 600px; height: 600px;
            background: radial-gradient(circle, rgba(168,85,247,0.07) 0%, transparent 70%);
            top: -150px; right: -150px;
            pointer-events: none;
            z-index: 0;
            animation: orbFloat 10s ease-in-out infinite alternate;
        }

        @keyframes orbFloat {
            from { transform: translate(0,0) scale(1); }
            to   { transform: translate(-30px, 40px) scale(1.1); }
        }

        .orb-left {
            position: fixed;
            width: 500px; height: 500px;
            background: radial-gradient(circle, rgba(14,165,233,0.08) 0%, transparent 70%);
            bottom: -100px; left: -100px;
            pointer-events: none;
            z-index: 0;
            animation: orbFloat 13s ease-in-out infinite alternate-reverse;
        }

        .topbar {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(6,13,31,0.85);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid var(--border);
            padding: 0 32px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .topbar-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: 'Space Mono', monospace;
            font-size: 13px;
        }

        .topbar-logo {
            width: 32px; height: 32px;
            background: linear-gradient(135deg, var(--violet), var(--cyan));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .topbar-brand span { color: var(--gray-300); }
        .topbar-brand strong { color: var(--white); }

        .topbar-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .status-dot {
            width: 8px; height: 8px;
            border-radius: 50%;
            background: var(--green);
            box-shadow: 0 0 8px var(--green);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50%       { opacity: 0.4; }
        }

        .btn-back {
            padding: 8px 16px;
            background: rgba(168,85,247,0.1);
            border: 1px solid rgba(168,85,247,0.3);
            border-radius: 8px;
            color: var(--violet);
            text-decoration: none;
            font-size: 12px;
            font-weight: 600;
        }

        .page-wrapper {
            position: relative;
            z-index: 1;
            max-width: 1180px;
            margin: 0 auto;
            padding: 48px 24px 80px;
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 32px;
            align-items: start;
        }

        .page-header {
            grid-column: 1 / -1;
            margin-bottom: 8px;
        }

        .page-eyebrow {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--violet);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .page-eyebrow::before {
            content: '';
            width: 24px; height: 2px;
            background: var(--violet);
        }

        .page-title {
            font-size: 36px;
            font-weight: 800;
            line-height: 1.1;
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, var(--white) 30%, var(--violet));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-subtitle {
            margin-top: 12px;
            color: var(--gray-300);
            font-size: 15px;
            font-weight: 300;
            line-height: 1.6;
            max-width: 640px;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            backdrop-filter: blur(12px);
        }

        .card-header {
            padding: 24px 32px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .card-header-icon {
            width: 40px; height: 40px;
            border-radius: 10px;
            background: linear-gradient(135deg, rgba(168,85,247,0.2), rgba(168,85,247,0.05));
            border: 1px solid rgba(168,85,247,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .card-header-text h3 {
            font-size: 16px;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 2px;
        }

        .card-header-text p {
            font-size: 12px;
            color: var(--gray-300);
        }

        .card-body { padding: 32px; }

        .section-divider {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 24px 0;
        }

        .section-divider-label {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: var(--gray-300);
            white-space: nowrap;
        }

        .section-divider-line {
            flex: 1;
            height: 1px;
            background: var(--border);
        }

        .field-group { margin-bottom: 24px; }

        .field-label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 13px;
            font-weight: 600;
            color: var(--gray-200);
        }

        .field-label .req {
            color: var(--violet);
            font-size: 16px;
            line-height: 1;
        }

        .field-hint {
            font-size: 11px;
            color: var(--gray-300);
            margin-bottom: 8px;
            font-weight: 300;
            font-style: italic;
        }

        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            background: rgba(15, 32, 68, 0.6);
            border: 1.5px solid rgba(168,85,247,0.2);
            color: var(--white);
            border-radius: 8px;
            padding: 13px 16px;
            font-family: 'Sora', sans-serif;
            font-size: 14px;
            transition: border-color 0.25s, box-shadow 0.25s, background 0.25s;
            appearance: none;
            -webkit-appearance: none;
            outline: none;
        }

        input::placeholder { color: rgba(148,163,184,0.5); }

        input:focus,
        select:focus,
        textarea:focus {
            border-color: var(--violet);
            background: rgba(15, 32, 68, 0.9);
            box-shadow: var(--glow);
        }

        input.error-field { border-color: var(--red) !important; }

        .select-wrapper {
            position: relative;
        }
        .select-wrapper::after {
            content: '‚ñæ';
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--violet);
            pointer-events: none;
            font-size: 14px;
        }
        .select-wrapper select { padding-right: 36px; cursor: pointer; }
        select option {
            background: var(--navy-800);
            color: var(--white);
        }

        .origin-type-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .type-card {
            padding: 16px;
            background: rgba(15,32,68,0.5);
            border: 1.5px solid rgba(168,85,247,0.15);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.25s;
            position: relative;
        }

        .type-card input {
            position: absolute;
            opacity: 0;
        }

        .type-card:hover {
            border-color: rgba(168,85,247,0.35);
        }

        .type-card:has(input:checked) {
            border-color: var(--violet);
            background: rgba(168,85,247,0.08);
            box-shadow: var(--glow);
        }

        .type-title {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--white);
        }

        .type-desc {
            font-size: 11px;
            color: var(--gray-300);
            line-height: 1.4;
        }

        .toggle-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 16px;
            background: rgba(15,32,68,0.5);
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .toggle-row:hover { 
            background: rgba(15,32,68,0.8); 
            border-color: rgba(168,85,247,0.3); 
        }

        .toggle-row:has(input:checked) { 
            border-color: rgba(168,85,247,0.5); 
            background: rgba(168,85,247,0.06); 
        }

        .toggle-info { flex: 1; }
        .toggle-info strong { 
            font-size: 13px; 
            font-weight: 600; 
            display: block; 
            margin-bottom: 2px; 
        }
        .toggle-info span { 
            font-size: 11px; 
            color: var(--gray-300); 
        }

        .toggle-switch {
            position: relative;
            width: 44px; 
            height: 24px;
            flex-shrink: 0;
        }
        .toggle-switch input { 
            opacity: 0; 
            width: 0; 
            height: 0; 
        }
        .toggle-slider {
            position: absolute;
            inset: 0;
            background: rgba(148,163,184,0.2);
            border-radius: 100px;
            transition: 0.3s;
            cursor: pointer;
        }
        .toggle-slider::before {
            content: '';
            position: absolute;
            height: 18px; 
            width: 18px;
            left: 3px; 
            bottom: 3px;
            background: var(--gray-300);
            border-radius: 50%;
            transition: 0.3s;
        }
        .toggle-switch input:checked + .toggle-slider {
            background: rgba(168,85,247,0.4);
        }
        .toggle-switch input:checked + .toggle-slider::before {
            transform: translateX(20px);
            background: var(--violet);
            box-shadow: 0 0 8px var(--violet);
        }

        .slider-container {
            padding: 16px;
            background: rgba(15,32,68,0.5);
            border: 1px solid var(--border);
            border-radius: 8px;
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .slider-value {
            font-family: 'Space Mono', monospace;
            font-size: 18px;
            font-weight: 700;
            color: var(--violet);
        }

        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(148,163,184,0.2);
            padding: 0;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--violet);
            cursor: pointer;
            box-shadow: 0 0 8px var(--violet);
        }

        .url-preview {
            background: rgba(6,13,31,0.8);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            margin-top: 12px;
            font-family: 'Space Mono', monospace;
        }

        .url-preview-label {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--gray-300);
            margin-bottom: 8px;
        }

        .url-preview-value {
            font-size: 14px;
            color: var(--violet);
            word-break: break-all;
            padding: 10px;
            background: rgba(168,85,247,0.08);
            border-radius: 6px;
        }

        .edge-locations {
            background: rgba(15,32,68,0.5);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            margin-top: 12px;
        }

        .edge-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 10px;
        }

        .edge-badge {
            padding: 6px 10px;
            background: rgba(168,85,247,0.08);
            border: 1px solid rgba(168,85,247,0.2);
            border-radius: 6px;
            text-align: center;
            font-size: 11px;
            font-family: 'Space Mono', monospace;
        }

        .validation-msg {
            font-size: 11px;
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
            min-height: 16px;
        }
        .validation-msg.error { color: #f87171; }
        .validation-msg.success { color: var(--green); }

        .btn-primary {
            width: 100%;
            padding: 17px;
            background: linear-gradient(135deg, var(--violet) 0%, var(--violet-dim) 100%);
            border: none;
            border-radius: 10px;
            color: var(--white);
            font-family: 'Sora', sans-serif;
            font-size: 15px;
            font-weight: 700;
            letter-spacing: 0.04em;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn-primary::before {
            content: '';
            position: absolute;
            top: -50%; left: -60%;
            width: 200%; height: 200%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
            transform: rotate(30deg) translateX(-100%);
            transition: transform 0.6s;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 16px 40px rgba(168,85,247,0.4);
        }
        .btn-primary:hover::before { transform: rotate(30deg) translateX(200%); }
        .btn-primary:active { transform: translateY(0); }

        .spinner {
            width: 18px; height: 18px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: var(--white);
            border-radius: 50%;
            animation: spin 0.7s linear infinite;
            display: none;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        .side-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .info-panel {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .info-panel-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            font-size: 12px;
            font-family: 'Space Mono', monospace;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--violet);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-item {
            padding: 14px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }
        .info-item:last-child { border-bottom: none; }

        .info-item-icon {
            font-size: 18px;
            flex-shrink: 0;
            margin-top: 1px;
        }

        .info-item-title {
            font-size: 12px;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 3px;
        }
        .info-item-desc {
            font-size: 11px;
            color: var(--gray-300);
            line-height: 1.5;
        }

        .resource-list { padding: 16px 20px; }

        .resource-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
            font-size: 12px;
        }
        .resource-item:last-child { border-bottom: none; }

        .resource-icon {
            width: 28px; height: 28px;
            border-radius: 6px;
            background: rgba(168,85,247,0.12);
            border: 1px solid rgba(168,85,247,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            flex-shrink: 0;
        }

        .resource-name { font-weight: 600; color: var(--white); margin-bottom: 1px; }
        .resource-type { color: var(--gray-300); font-size: 10px; font-family: 'Space Mono', monospace; }

        .alert-banner {
            display: none;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 13px;
            margin-bottom: 24px;
            align-items: flex-start;
            gap: 10px;
        }
        .alert-banner.error {
            background: rgba(239,68,68,0.1);
            border: 1px solid rgba(239,68,68,0.3);
            color: #fca5a5;
            display: flex;
        }

        @media (max-width: 900px) {
            .page-wrapper {
                grid-template-columns: 1fr;
                padding: 32px 16px 60px;
            }
            .origin-type-grid { grid-template-columns: 1fr; }
            .edge-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        .card { animation: fadeInUp 0.5s ease-out both; }
        .side-panel > * { animation: fadeInUp 0.5s ease-out both; }
        .side-panel > *:nth-child(2) { animation-delay: 0.08s; }

        .footer-note {
            grid-column: 1 / -1;
            text-align: center;
            font-size: 11px;
            color: var(--gray-300);
            margin-top: 8px;
            font-family: 'Space Mono', monospace;
        }
    </style>
</head>
<body>
<div class="orb-left"></div>

<header class="topbar">
    <div class="topbar-brand">
        <div class="topbar-logo">üöÄ</div>
        <span>PROJET IAC</span> <strong>SONATEL</strong>
    </div>
    <div class="topbar-right">
        <a href="/" class="btn-back">‚Üê Tous les services</a>
        <div style="font-family: 'Space Mono', monospace; font-size: 11px; color: var(--gray-300); display: flex; align-items: center; gap: 6px;">
            <div class="status-dot"></div>
            Services op√©rationnels
        </div>
    </div>
</header>

<main class="page-wrapper">

    <div class="page-header">
        <div class="page-eyebrow">Infrastructure as Code ¬∑ AWS CloudFront</div>
        <h1 class="page-title">D√©ploiement CloudFront<br>Content Delivery Network</h1>
        <p class="page-subtitle">
            Cr√©ez une distribution CDN globale pour acc√©l√©rer la livraison de contenu avec 600+ edge locations, 
            cache intelligent, SSL/TLS et protection DDoS int√©gr√©e.
        </p>
    </div>

    <div class="card">
        <div class="card-header">
            <div class="card-header-icon">üöÄ</div>
            <div class="card-header-text">
                <h3>Configuration CloudFront</h3>
                <p>CDN mondial avec cache distribu√©</p>
            </div>
        </div>

        <div class="card-body">
            <div id="alertBanner" class="alert-banner error">
                <span>‚ö†Ô∏è</span>
                <span id="alertText"></span>
            </div>

            <form method="post" action="/cloudfront/trigger" id="cloudfrontForm">

                <div class="section-divider">
                    <span class="section-divider-label">01 ‚Äî Origine du contenu</span>
                    <div class="section-divider-line"></div>
                </div>

                <div class="field-group">
                    <label class="field-label">Type d'origine <span class="req">*</span></label>
                    <div class="origin-type-grid">
                        <label class="type-card">
                            <input type="radio" name="origin_type" value="s3" checked>
                            <div class="type-title">ü™£ S3 Bucket</div>
                            <div class="type-desc">Bucket S3 pour sites statiques, images, vid√©os</div>
                        </label>
                        <label class="type-card">
                            <input type="radio" name="origin_type" value="custom">
                            <div class="type-title">üåê Custom Origin</div>
                            <div class="type-desc">ALB, EC2, serveur externe (HTTP/HTTPS)</div>
                        </label>
                    </div>
                </div>

                <div class="field-group">
                    <label class="field-label" for="origin_domain">
                        Domaine d'origine <span class="req">*</span>
                    </label>
                    <p class="field-hint" id="originHint">Ex: mon-bucket.s3.amazonaws.com ou mon-alb-123.us-east-1.elb.amazonaws.com</p>
                    <input
                        type="text"
                        id="origin_domain"
                        name="origin_domain"
                        placeholder="mon-bucket.s3.amazonaws.com"
                        required
                    >
                    <div class="validation-msg" id="originValidation"></div>
                </div>

                <div class="field-group">
                    <label class="field-label" for="distribution_comment">
                        Description
                    </label>
                    <input
                        type="text"
                        id="distribution_comment"
                        name="distribution_comment"
                        placeholder="ex: CDN pour site web production"
                    >
                </div>

                <div class="section-divider">
                    <span class="section-divider-label">02 ‚Äî Domaines et SSL</span>
                    <div class="section-divider-line"></div>
                </div>

                <div class="field-group">
                    <label class="field-label" for="aliases">
                        Domaines alternatifs (CNAME)
                    </label>
                    <p class="field-hint">Vos domaines personnalis√©s (s√©par√©s par virgule). Ex: www.example.com, cdn.example.com</p>
                    <textarea
                        id="aliases"
                        name="aliases"
                        placeholder="www.example.com, cdn.example.com"
                        rows="2"
                    ></textarea>
                </div>

                <div class="field-group">
                    <label class="field-label" for="acm_certificate_arn">
                        ARN du certificat SSL (ACM)
                    </label>
                    <p class="field-hint">‚ö†Ô∏è Certificat DOIT √™tre dans la r√©gion us-east-1 pour CloudFront</p>
                    <input
                        type="text"
                        id="acm_certificate_arn"
                        name="acm_certificate_arn"
                        placeholder="arn:aws:acm:us-east-1:123456789:certificate/xxxxx"
                    >
                </div>

                <div class="section-divider">
                    <span class="section-divider-label">03 ‚Äî Comportement du cache</span>
                    <div class="section-divider-line"></div>
                </div>

                <div class="field-group">
                    <label class="field-label">TTL par d√©faut (Time To Live)</label>
                    <div class="slider-container">
                        <div class="slider-header">
                            <span style="font-size: 12px; color: var(--gray-300);">0s</span>
                            <span class="slider-value"><span id="ttlValue">86400</span>s</span>
                            <span style="font-size: 12px; color: var(--gray-300);">7 jours</span>
                        </div>
                        <input
                            type="range"
                            name="default_ttl"
                            id="default_ttl"
                            min="0"
                            max="604800"
                            step="3600"
                            value="86400"
                        >
                    </div>
                    <p class="field-hint" style="margin-top: 8px;">86400s (24h) recommand√©. 0s = pas de cache.</p>
                </div>

                <div class="field-group">
                    <label class="field-label">Price Class</label>
                    <div class="select-wrapper">
                        <select name="price_class">
                            <option value="PriceClass_100">üí∞ Price Class 100 (USA, Europe, Asie) - Recommand√©</option>
                            <option value="PriceClass_200">üí∞üí∞ Price Class 200 (+ Afrique, Moyen-Orient, Am√©rique Sud)</option>
                            <option value="PriceClass_All">üí∞üí∞üí∞ Price Class All (Toutes les edge locations)</option>
                        </select>
                    </div>
                </div>

                <div class="section-divider">
                    <span class="section-divider-label">04 ‚Äî Options avanc√©es</span>
                    <div class="section-divider-line"></div>
                </div>

                <div class="toggle-row" for="compress">
                    <div class="toggle-info">
                        <strong>Compression automatique</strong>
                        <span>Compresse les fichiers (gzip, brotli) pour r√©duire la bande passante</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="compress" name="compress" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="toggle-row" for="ipv6">
                    <div class="toggle-info">
                        <strong>IPv6</strong>
                        <span>Active le support IPv6 pour la distribution</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="ipv6" name="ipv6" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="toggle-row" for="logging">
                    <div class="toggle-info">
                        <strong>Access Logs</strong>
                        <span>Enregistre toutes les requ√™tes dans un bucket S3</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="logging" name="logging">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <div class="field-group">
                    <label class="field-label">Politique de protocole</label>
                    <div class="select-wrapper">
                        <select name="viewer_protocol_policy">
                            <option value="redirect-to-https">üîí Redirect to HTTPS (Recommand√©)</option>
                            <option value="https-only">üîê HTTPS Only</option>
                            <option value="allow-all">üåê Allow All (HTTP + HTTPS)</option>
                        </select>
                    </div>
                </div>

                <div class="field-group">
                    <label class="field-label">Aper√ßu de la distribution</label>
                    <div class="url-preview">
                        <div class="url-preview-label">CloudFront Domain</div>
                        <div class="url-preview-value" id="cfDomainPreview">
                            d1234abcdef5gh.cloudfront.net
                        </div>
                    </div>
                    <p class="field-hint" style="margin-top: 8px;">
                        üí° Cr√©ez un CNAME dans Route 53: www.example.com ‚Üí d1234abcdef5gh.cloudfront.net
                    </p>
                </div>

                <div class="field-group">
                    <label class="field-label">Edge Locations mondiales</label>
                    <div class="edge-locations">
                        <div style="font-size: 12px; margin-bottom: 8px;">600+ points de pr√©sence dans le monde</div>
                        <div class="edge-grid">
                            <div class="edge-badge">üá∫üá∏ USA</div>
                            <div class="edge-badge">üá™üá∫ Europe</div>
                            <div class="edge-badge">üáØüáµ Asie</div>
                            <div class="edge-badge">üáßüá∑ Am. Sud</div>
                            <div class="edge-badge">üáøüá¶ Afrique</div>
                            <div class="edge-badge">üá¶üá∫ Oc√©anie</div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 32px">
                    <button type="submit" class="btn-primary" id="submitBtn">
                        <span class="spinner" id="spinner"></span>
                        <span id="btnText">üöÄ Cr√©er la distribution CloudFront</span>
                    </button>
                </div>

                <p style="text-align:center; margin-top:12px; font-size:11px; color: var(--gray-300); font-family:'Space Mono',monospace;">
                    ‚è±Ô∏è Le d√©ploiement peut prendre 15-30 minutes pour se propager mondialement
                </p>

            </form>
        </div>
    </div>

    <div class="side-panel">

        <div class="info-panel">
            <div class="info-panel-header">üèóÔ∏è Ressources Terraform cr√©√©es</div>
            <div class="resource-list">
                <div class="resource-item">
                    <div class="resource-icon">üöÄ</div>
                    <div>
                        <div class="resource-name">aws_cloudfront_distribution</div>
                        <div class="resource-type">DISTRIBUTION CDN</div>
                    </div>
                </div>
                <div class="resource-item">
                    <div class="resource-icon">üîê</div>
                    <div>
                        <div class="resource-name">aws_cloudfront_origin_access_identity</div>
                        <div class="resource-type">OAI (pour S3)</div>
                    </div>
                </div>
                <div class="resource-item">
                    <div class="resource-icon">‚öôÔ∏è</div>
                    <div>
                        <div class="resource-name">aws_cloudfront_cache_policy</div>
                        <div class="resource-type">POLITIQUE DE CACHE</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="info-panel">
            <div class="info-panel-header">üí∞ Co√ªts estim√©s</div>
            <div class="info-item">
                <div class="info-item-icon">üìä</div>
                <div>
                    <div class="info-item-title">Transfert de donn√©es</div>
                    <div class="info-item-desc">
                        ‚Ä¢ 1 TB/mois: ~$85<br>
                        ‚Ä¢ 10 TB/mois: ~$850<br>
                        ‚Ä¢ 50 TB/mois: ~$4,250<br>
                        Prix d√©gressifs avec le volume
                    </div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-item-icon">üîÑ</div>
                <div>
                    <div class="info-item-title">Requ√™tes HTTP/HTTPS</div>
                    <div class="info-item-desc">
                        $0.0075 - $0.016 par 10,000 requ√™tes selon la r√©gion. 10 millions de requ√™tes ‚âà $10-15.
                    </div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-item-icon">üéÅ</div>
                <div>
                    <div class="info-item-title">Free Tier (1√®re ann√©e)</div>
                    <div class="info-item-desc">
                        1 TB de transfert sortant + 10 millions de requ√™tes HTTP/HTTPS gratuits/mois.
                    </div>
                </div>
            </div>
        </div>

        <div class="info-panel">
            <div class="info-panel-header">üí° Informations importantes</div>
            <div class="info-item">
                <div class="info-item-icon">üåç</div>
                <div>
                    <div class="info-item-title">Propagation mondiale</div>
                    <div class="info-item-desc">
                        Le d√©ploiement initial prend 15-30min pour se propager aux 600+ edge locations mondiales.
                    </div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-item-icon">üîÑ</div>
                <div>
                    <div class="info-item-title">Invalidation du cache</div>
                    <div class="info-item-desc">
                        Commande: <code style="font-size: 10px;">aws cloudfront create-invalidation --distribution-id ID --paths "/*"</code><br>
                        1000 chemins/mois gratuits, puis $0.005/chemin.
                    </div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-item-icon">üîí</div>
                <div>
                    <div class="info-item-title">Certificat SSL</div>
                    <div class="info-item-desc">
                        Pour domaines personnalis√©s, demandez un certificat ACM dans us-east-1. Gratuit et auto-renouvel√©.
                    </div>
                </div>
            </div>
            <div class="info-item">
                <div class="info-item-icon">üõ°Ô∏è</div>
                <div>
                    <div class="info-item-title">S√©curit√©</div>
                    <div class="info-item-desc">
                        Protection DDoS gratuite via AWS Shield Standard. AWS WAF disponible pour filtrage avanc√©.
                    </div>
                </div>
            </div>
        </div>

    </div>

    <p class="footer-note">
        PROJET IAC SONATEL ¬∑ CloudFront Deployer ¬∑ Terraform + GitHub Actions
    </p>

</main>

<script>
    const originTypeInputs = document.querySelectorAll('input[name="origin_type"]');
    const originDomainInput = document.getElementById('origin_domain');
    const originHint = document.getElementById('originHint');
    const originValidation = document.getElementById('originValidation');
    const ttlSlider = document.getElementById('default_ttl');
    const ttlValue = document.getElementById('ttlValue');
    const cfDomainPreview = document.getElementById('cfDomainPreview');
    const form = document.getElementById('cloudfrontForm');
    const submitBtn = document.getElementById('submitBtn');
    const spinner = document.getElementById('spinner');
    const btnText = document.getElementById('btnText');
    const alert = document.getElementById('alertBanner');
    const alertText = document.getElementById('alertText');

    originTypeInputs.forEach(input => {
        input.addEventListener('change', () => {
            if (input.value === 's3') {
                originHint.textContent = 'Ex: mon-bucket.s3.amazonaws.com ou mon-bucket.s3.us-east-1.amazonaws.com';
                originDomainInput.placeholder = 'mon-bucket.s3.amazonaws.com';
            } else {
                originHint.textContent = 'Ex: mon-alb-123.us-east-1.elb.amazonaws.com ou api.example.com';
                originDomainInput.placeholder = 'mon-alb-123.us-east-1.elb.amazonaws.com';
            }
        });
    });

    originDomainInput.addEventListener('input', () => {
        const val = originDomainInput.value;
        if (!val) {
            originValidation.textContent = '';
            originValidation.className = 'validation-msg';
            return;
        }

        const originType = document.querySelector('input[name="origin_type"]:checked').value;
        
        if (originType === 's3' && !val.includes('.s3')) {
            originValidation.textContent = '‚ö†Ô∏è Domaine S3 doit contenir ".s3"';
            originValidation.className = 'validation-msg error';
        } else if (!val.includes('.')) {
            originValidation.textContent = '‚ùå Domaine invalide';
            originValidation.className = 'validation-msg error';
        } else {
            originValidation.textContent = '‚úÖ Domaine valide';
            originValidation.className = 'validation-msg success';
        }

        updateCfDomainPreview();
    });

    ttlSlider.addEventListener('input', () => {
        const seconds = parseInt(ttlSlider.value);
        if (seconds === 0) {
            ttlValue.textContent = '0 (pas de cache)';
        } else if (seconds < 3600) {
            ttlValue.textContent = `${Math.floor(seconds / 60)}min`;
        } else if (seconds < 86400) {
            ttlValue.textContent = `${Math.floor(seconds / 3600)}h`;
        } else {
            ttlValue.textContent = `${Math.floor(seconds / 86400)}j`;
        }
    });

    function updateCfDomainPreview() {
        const randomId = Math.random().toString(36).substring(2, 15);
        cfDomainPreview.textContent = `d${randomId}.cloudfront.net`;
    }

    function showAlert(msg) {
        alertText.textContent = msg;
        alert.style.display = 'flex';
        alert.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function hideAlert() {
        alert.style.display = 'none';
    }

    document.querySelectorAll('.toggle-row').forEach(row => {
        row.addEventListener('click', e => {
            if (e.target.tagName === 'INPUT') return;
            const cb = row.querySelector('input[type="checkbox"]');
            if (cb) cb.checked = !cb.checked;
        });
    });

    form.addEventListener('submit', function(e) {
        hideAlert();

        const originDomain = originDomainInput.value.trim();
        const aliases = document.getElementById('aliases').value.trim();
        const acmArn = document.getElementById('acm_certificate_arn').value.trim();

        if (!originDomain) {
            e.preventDefault();
            showAlert('Le domaine d\'origine est obligatoire');
            originDomainInput.focus();
            return false;
        }

        if (aliases && !acmArn) {
            e.preventDefault();
            showAlert('Un certificat ACM est requis pour utiliser des domaines personnalis√©s (CNAME)');
            document.getElementById('acm_certificate_arn').focus();
            return false;
        }

        if (acmArn && !acmArn.includes('us-east-1')) {
            if (!confirm('‚ö†Ô∏è Le certificat ACM doit √™tre dans us-east-1 pour CloudFront. √ätes-vous s√ªr qu\'il est dans la bonne r√©gion ?')) {
                e.preventDefault();
                return false;
            }
        }

        spinner.style.display = 'block';
        btnText.textContent = 'Pipeline en cours...';
        submitBtn.disabled = true;
    });

    // Initial TTL display
    ttlSlider.dispatchEvent(new Event('input'));
    updateCfDomainPreview();
</script>
</body>
</html>